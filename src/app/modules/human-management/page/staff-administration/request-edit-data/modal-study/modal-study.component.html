<div class="container">
    <div class="header">
        <h1>Datos de Estudio</h1>
        <hr style="width: 100%;"> 
    </div>

    <div class="add__phone" style="margin-bottom: 10px;">
        <button mat-raised-button color="primary" *ngIf="!isNewStuden"
            (click)="addstuden()">Agregar Estudios</button>
    </div>

    <form [formGroup]="formStuden" *ngIf="isNewStuden">
        <div class="inptus__address">
            <div class="inptus__address__group flex-container">
                <mat-form-field appearance="fill">
                    <mat-label>Carrera/Especialidad <strong class="obligatory">*</strong></mat-label>
                    <input type="text" formControlName="scarreer" matInput
                        placeholder="Ingrese la Carrera/Especialidad">
                    <mat-error *ngIf="formStuden.controls.scarreer.touched && formStuden.controls.scarreer.invalid">
                        <span *ngIf="formStuden.controls.scarreer.errors.required">Carrera/Especialidad es requerida
                        </span>
                        <span *ngIf="formStuden.controls.scarreer.errors.pattern">Carrera/Especialidad es inválido
                        </span>
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Tipo de Nivel <strong class="obligatory">*</strong>
                    </mat-label>
                    <mat-select  formControlName="nid_instruction">
                        <mat-option *ngFor="let item of listinstruccion" [value]="item.nid_mastertable">{{
                            item.sdescription_value
                            }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="formStuden.controls.nid_instruction.touched && formStuden.controls.nid_instruction.invalid">
                        <span *ngIf="formStuden.controls.nid_instruction.errors.required">Nivel es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Centro de Estudio</mat-label>
                    <input type="text" formControlName="sstudy_center" matInput
                        placeholder="Ingrese Centro de Estudio">
                    <mat-error *ngIf="formStuden.controls.sstudy_center.touched && formStuden.controls.sstudy_center.invalid">
                        <small *ngIf="formStuden.controls.sstudy_center.errors.required">Centro de Estudio es requerido
                        </small>
                        <small *ngIf="formStuden.controls.sstudy_center.errors.pattern">Centro de Estudio es <strong>inválido</strong>
                        </small>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="inptus__address__group">
                <mat-form-field appearance="fill" fxFlex="33">
                    <mat-label>Departamento <strong class="obligatory">*</strong>
                    </mat-label>
                    <mat-select formControlName="nid_departament">
                        <mat-option *ngFor="let item of departament" [value]="item.nid_department">{{
                            item.sname
                            }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="formStuden.controls.nid_departament.touched &&
                    formStuden.controls.nid_departament.invalid
          ">
                        <span *ngIf="formStuden.controls.nid_departament.errors.required">Departamento
                            es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill" fxFlex="33">
                    <mat-label>Province <strong class="obligatory">*</strong></mat-label>
                    <mat-select [disabled]="!blockProvince" formControlName="nid_province">
                        <mat-option *ngFor="let item of province" [value]="item.nid_province">{{
                            item.sname
                            }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="formStuden.controls.nid_province.touched &&
                    formStuden.controls.nid_province.invalid
          ">
                        <span *ngIf="formStuden.controls.nid_province.errors.required">Provincia
                            es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill" fxFlex="33">
                    <mat-label>Distrito <strong class="obligatory">*</strong></mat-label>
                    <mat-select [disabled]="!blockDistrict" formControlName="nid_district">
                        <mat-option *ngFor="let item of district" [value]="item.nid_district">{{
                            item.sname
                            }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="formStuden.controls.nid_district.touched &&
                    formStuden.controls.nid_district.invalid
          ">
                        <span *ngIf="formStuden.controls.nid_district.errors.required">Distrito
                            es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="inptus__address__group flex-container">
                <mat-form-field appearance="fill">
                    <mat-label>Situación Actual</mat-label>
                    <mat-select formControlName="scurrent_cycle">
                        <mat-option *ngFor="let item of lstStateStudy" [value]="item.nid_mastertable">{{
                            item.sdescription_value
                            }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="formStuden.controls.scurrent_cycle.touched &&
                    formStuden.controls.scurrent_cycle.invalid">
                        <span *ngIf="formStuden.controls.scurrent_cycle.errors.required">Trancurso
                            Actual
                            es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Fecha Inicio</mat-label>
                    <input formControlName="dateStart" matInput [matDatepicker]="pickerscurrent"
                        readonly />
                    <mat-datepicker-toggle matSuffix [for]="pickerscurrent"></mat-datepicker-toggle>
                    <mat-datepicker #pickerscurrent></mat-datepicker>
                    <mat-error *ngIf="formStuden.controls.dateStart.touched &&
                    formStuden.controls.dateStart.invalid">
                        <span *ngIf="formStuden.controls.dateStart.errors.required">Fecha inicio
                            es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Fecha Fin</mat-label>
                    <input formControlName="dateEnd" matInput [matDatepicker]="pickerscurrentend" [max]="maxDate"
                        readonly />
                    <mat-datepicker-toggle matSuffix [for]="pickerscurrentend"></mat-datepicker-toggle>
                    <mat-datepicker #pickerscurrentend></mat-datepicker>
                    <mat-error *ngIf="formStuden.controls.dateEnd.touched &&
                    formStuden.controls.dateEnd.invalid">
                        <span *ngIf="formStuden.controls.dateEnd.errors.required">Fecha Fin
                            es <strong>requerido</strong>
                        </span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="inptus__address__group">                
                <input type="file" class="file-input" fxFlex="33"
                (change)="onFileSelected($event)" #fileUpload>

                <div class="file-upload" style="display: flex">

                {{fileName || "Ningun archivo cargado"}}

                    <button style="margin-left: 5px;" mat-mini-fab   class="upload-btn"
                    (click)="fileUpload.click()">
                        <mat-icon style="color: #000;">attach_file</mat-icon>
                    </button>
                </div>
            </div>
            <div class="inptus__address__button" style="margin-top:10px;">
                <button mat-raised-button color="primary"
                    *ngIf="isNewStuden" (click)="saveStuden()">Guardar</button>
                <button mat-raised-button color="warn"
                    *ngIf="isNewStuden" (click)="cancelStuden()">Cancelar</button>
            </div>

        </div>
    </form>
    <div>
        <table mat-table [dataSource]="studenDT" matSort class="w-100">
            <ng-container matColumnDef="option" sticky>
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Opción</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile" data-label="Opción: ">
                    <button   mat-button (click)="editStuden(row)">
                        <mat-icon color="accent">touch_app</mat-icon>
                    </button>
                    <button  *ngIf="row.bactive === true" mat-button (click)="deleteStuden(row)">
                        <mat-icon color="accent">block</mat-icon>
                    </button>
                </td>
            </ng-container>
            <ng-container matColumnDef="instruccion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Nivel académico</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Nivel académico : ">
                    {{ row.sdescription_value }}
                </td>
            </ng-container>
            <ng-container matColumnDef="scarreer">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Carrera</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Carrera : ">
                    {{ row.scarreer }}
                </td>
            </ng-container>
            <ng-container matColumnDef="sstudy_center">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Centro de Estudio</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Centro de Estudio : ">
                    {{ row.sstudy_center }}
                </td>
            </ng-container>
            <ng-container matColumnDef="scurrent_cycle">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Situación  Actual</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Situación  Actual : ">
                    {{ row.scurrent_cycle }}
                </td>
            </ng-container>
            <ng-container matColumnDef="dateStart">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Inicio</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Fecha Inicio : ">
                    {{ row.dateStart | date:'dd/MM/YYYY' }}
                </td>
            </ng-container>
            <ng-container matColumnDef="dateEnd">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Fin</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Fecha Fin : ">
                    {{ row.dateEnd | date:'dd/MM/YYYY' }}
                </td>
            </ng-container>
            <ng-container matColumnDef="state">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Estado</th>
                <td mat-cell *matCellDef="let row" class="has_label_on_mobile"
                    data-label="Estado : ">
                    {{ row.nstate }}
                </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumnstudent; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnstudent"></tr>

            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell text-center" colspan="8">
                    No se encontraron datos
                </td>
            </tr>
        </table>
    </div>
    <!-- <mat-paginator #paginatorstudent [pageSizeOptions]="[5, 10, 20]"></mat-paginator> -->
 
    <div style="display: flex;
    justify-content: center;
    align-items: center;">
      
      <!-- <span>Regresar</span> -->
      <mat-paginator
      style-paginator
      showFirstLastButtons
      [showTotalPages]="3"
      (changedPageNumber)="changedPageNumber($event)"
      #paginator
      [pageIndex]="currentPage"
      [length]="cargoFilter.pagination.totalItems"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      (page)="changedPageSize($event)"
      style="display: none;">
      </mat-paginator>
      <!-- <span style="padding-left: 15px;">Avanzar</span> -->
    </div>




    <div class="footer">
        <button mat-raised-button color="warn" (click)="cancel()">Cancelar</button>
    </div>
</div>